//about 700 lines long
